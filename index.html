<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å°ç£æ­·å²ä¸€æ¬¡æ€§æŒ‘æˆ°</title>
    <style>
        :root {
            --primary: #2c3e50;
            --accent: #3498db;
            --success: #27ae60;
            --error: #e74c3c;
            --bg: #f8f9fa;
        }
        body { font-family: "PingFang TC", "Microsoft JhengHei", sans-serif; background-color: var(--bg); display: flex; flex-direction: column; align-items: center; padding: 20px; }
        .card { background: white; padding: 20px; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); width: 100%; max-width: 500px; margin-bottom: 20px; }
        h1 { font-size: 1.4rem; text-align: center; margin-bottom: 10px; }
        .status-bar { text-align: center; font-weight: bold; margin-bottom: 15px; color: var(--accent); }
        
        /* é¸é …å€ */
        #options { display: flex; flex-wrap: wrap; gap: 8px; justify-content: center; min-height: 50px; border: 1px dashed #ccc; padding: 15px; border-radius: 8px; }
        .item { background: white; border: 2px solid var(--accent); color: var(--accent); padding: 6px 12px; border-radius: 5px; cursor: pointer; font-size: 0.9rem; transition: 0.2s; }
        .item:hover { background: var(--accent); color: white; }
        .item.selected { opacity: 0.3; cursor: not-allowed; background: #eee; border-color: #ccc; color: #999; }

        /* æ™‚é–“è»¸å€ */
        .slot { display: flex; align-items: center; margin-bottom: 10px; padding: 12px; background: #fff; border: 1px solid #ddd; border-radius: 8px; cursor: pointer; transition: 0.2s; }
        .slot:hover { border-color: var(--accent); background: #f0f7ff; }
        .slot.locked { cursor: default; background: #fdfdfd; }
        .year-label { font-weight: bold; width: 70px; font-size: 1.1rem; }
        .answer-text { flex-grow: 1; color: #888; border-left: 2px solid #eee; padding-left: 15px; }
        
        /* çµæœæ¨£å¼ */
        .res-correct { color: var(--success) !important; font-weight: bold; }
        .res-wrong { color: var(--error) !important; text-decoration: line-through; }
        .correct-ans { font-size: 0.8rem; color: var(--success); display: block; }

        #result-btn { display: none; width: 100%; padding: 12px; background: var(--primary); color: white; border: none; border-radius: 8px; font-size: 1rem; cursor: pointer; margin-top: 10px; }
    </style>
</head>
<body>

    <div class="card">
        <h1>ğŸ‡¹ğŸ‡¼ 17ä¸–ç´€å°ç£å²æ’åºæŒ‘æˆ°</h1>
        <div class="status-bar" id="status">è«‹å…ˆé»æ“Šä¸‹æ–¹ã€Œäº‹ä»¶ã€ï¼Œå†é»æ“Šå°æ‡‰çš„ã€Œå¹´ä»½ã€</div>
        <div id="options"></div>
    </div>

    <div class="card">
        <div id="timeline"></div>
        <button id="result-btn" onclick="showFinalResult()">æŸ¥çœ‹æœ€çµ‚åˆ†æ•¸</button>
        <button id="reset-btn" onclick="location.reload()" style="margin-top:10px; width:100%; padding:10px; background:#95a5a6; color:white; border:none; border-radius:8px; cursor:pointer;">é‡æ–°é–‹å§‹éŠæˆ²</button>
    </div>

    <script>
        const data = [
            { year: "1624", event: "è·è˜­äººä½”é ˜å—éƒ¨" },
            { year: "1626", event: "è¥¿ç­ç‰™äººä½”é ˜åŒ—éƒ¨" },
            { year: "1642", event: "è·è˜­äººåŒ—ä¸Šé©…é€è¥¿ç­ç‰™äºº" },
            { year: "1652", event: "éƒ­æ‡·ä¸€äº‹ä»¶" },
            { year: "1661", event: "é„­æˆåŠŸç”±æ¾æ¹–é–‹å§‹æ”»é€²å°ç£" },
            { year: "1662", event: "é„­æˆåŠŸæ“Šæ•—è·è˜­äºº" },
            { year: "1684", event: "å°ç£æˆç‚ºæ¸…å¸åœ‹é ˜åœŸ" }
        ];

        let selectedEvent = null;
        let selectedElement = null;
        let answeredCount = 0;
        let userAnswers = {}; // å„²å­˜æ ¼å¼: { "1624": "äº‹ä»¶åç¨±" }

        function init() {
            const optionsDiv = document.getElementById('options');
            const timelineDiv = document.getElementById('timeline');

            // éš¨æ©Ÿæ‰“äº‚äº‹ä»¶
            [...data].sort(() => Math.random() - 0.5).forEach(item => {
                const div = document.createElement('div');
                div.className = 'item';
                div.innerText = item.event;
                div.onclick = () => {
                    if (div.classList.contains('selected')) return;
                    // å–æ¶ˆä¹‹å‰é¸ä¸­çš„é«˜äº®
                    if (selectedElement) selectedElement.style.background = "white";
                    if (selectedElement) selectedElement.style.color = "var(--accent)";
                    
                    selectedEvent = item.event;
                    selectedElement = div;
                    div.style.background = "var(--accent)";
                    div.style.color = "white";
                    document.getElementById('status').innerText = `å·²é¸å–ï¼šã€Œ${selectedEvent}ã€ï¼Œè«‹é¸æ“‡å¹´ä»½`;
                };
                optionsDiv.appendChild(div);
            });

            // å»ºç«‹å¹´ä»½æ§½
            data.forEach(item => {
                const div = document.createElement('div');
                div.className = 'slot';
                div.id = `slot-${item.year}`;
                div.innerHTML = `<span class="year-label">${item.year}</span><span class="answer-text" id="text-${item.year}">å°šæœªé¸æ“‡...</span>`;
                div.onclick = () => fillAnswer(item.year, div);
                timelineDiv.appendChild(div);
            });
        }

        function fillAnswer(year, slotElement) {
            if (!selectedEvent || slotElement.classList.contains('locked')) return;

            // å¡«å…¥ç­”æ¡ˆ
            userAnswers[year] = selectedEvent;
            document.getElementById(`text-${year}`).innerText = selectedEvent;
            document.getElementById(`text-${year}`).style.color = "#333";
            document.getElementById(`text-${year}`).style.fontStyle = "normal";

            // é–å®šç‹€æ…‹
            slotElement.classList.add('locked');
            selectedElement.classList.add('selected');
            selectedElement.style.background = "#eee";
            
            // é‡è¨­é¸å–å™¨
            selectedEvent = null;
            selectedElement = null;
            answeredCount++;
            document.getElementById('status').innerText = `å·²å¡«å¯« ${answeredCount} / ${data.length}`;

            if (answeredCount === data.length) {
                document.getElementById('result-btn').style.display = 'block';
                document.getElementById('status').innerText = "å…¨éƒ¨å¡«å¯«å®Œç•¢ï¼Œè«‹æäº¤ï¼";
            }
        }

        function showFinalResult() {
            let score = 0;
            data.forEach(item => {
                const textEl = document.getElementById(`text-${item.year}`);
                const slotEl = document.getElementById(`slot-${item.year}`);
                
                if (userAnswers[item.year] === item.event) {
                    score++;
                    textEl.className = "answer-text res-correct";
                    textEl.innerText = "âœ“ " + userAnswers[item.year];
                } else {
                    textEl.className = "answer-text res-wrong";
                    textEl.innerHTML = `âœ• ${userAnswers[item.year]} <span class="correct-ans">æ­£ç¢ºç­”æ¡ˆï¼š${item.event}</span>`;
                }
            });

            document.getElementById('result-btn').style.display = 'none';
            document.getElementById('status').innerHTML = `æ¸¬é©—çµæŸï¼æ‚¨çš„å¾—åˆ†ï¼š<span style="font-size:1.5rem; color:var(--error)">${score} / ${data.length}</span>`;
            window.scrollTo(0, 0);
        }

        init();
    </script>
</body>
</html>